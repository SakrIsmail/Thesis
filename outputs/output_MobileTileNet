Train: 5742, Val: 638, Test: 1596
Anchor part: back_pedal
Average anchor position: [323.4758003 289.5394436]
Average offsets for parts (example): {'back_pedal': array([0., 0.]), 'back_hand_break': array([ -41.00623624, -164.98789435]), 'front_pedal': array([28.69489194, 19.22082515])}
Epoch 1
Train Loss: 0.4777, Time: 10.28s, Saved pixels: 65.62%
Loss: 0.4438
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    1.00    |
|    Average Batch Time (s)     |   0.0286   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1964.14   |
|   Energy Consumption (kWh)    | 0.0044 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 2
Train Loss: 0.4294, Time: 9.75s, Saved pixels: 65.62%
Loss: 0.4260
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    2.00    |
|    Average Batch Time (s)     |   0.0272   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1986.59   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 3
Train Loss: 0.4031, Time: 10.26s, Saved pixels: 65.62%
Loss: 0.4135
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    3.00    |
|    Average Batch Time (s)     |   0.0286   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1978.42   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 4
Train Loss: 0.3760, Time: 10.25s, Saved pixels: 65.62%
Loss: 0.4079
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    4.00    |
|    Average Batch Time (s)     |   0.0286   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1976.79   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 5
Train Loss: 0.3505, Time: 10.01s, Saved pixels: 65.62%
Loss: 0.4126
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    5.00    |
|    Average Batch Time (s)     |   0.0279   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1977.00   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 6
Train Loss: 0.3252, Time: 10.02s, Saved pixels: 65.62%
Loss: 0.4139
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    6.00    |
|    Average Batch Time (s)     |   0.0279   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1970.15   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 7
Train Loss: 0.3002, Time: 10.36s, Saved pixels: 65.62%
Loss: 0.4186
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    7.00    |
|    Average Batch Time (s)     |   0.0289   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1965.96   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 8
Train Loss: 0.2764, Time: 10.44s, Saved pixels: 65.62%
Loss: 0.4287
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    8.00    |
|    Average Batch Time (s)     |   0.0291   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1975.09   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 9
Train Loss: 0.2516, Time: 9.67s, Saved pixels: 65.62%
Loss: 0.4518
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    9.00    |
|    Average Batch Time (s)     |   0.0269   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1972.86   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 10
Train Loss: 0.2283, Time: 9.78s, Saved pixels: 65.62%
Loss: 0.4640
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   10.00    |
|    Average Batch Time (s)     |   0.0272   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1970.85   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 11
Train Loss: 0.2112, Time: 9.54s, Saved pixels: 65.62%
Loss: 0.4715
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   11.00    |
|    Average Batch Time (s)     |   0.0266   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1973.07   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 12
Train Loss: 0.1944, Time: 9.77s, Saved pixels: 65.62%
Loss: 0.4977
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   12.00    |
|    Average Batch Time (s)     |   0.0272   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1942.21   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 13
Train Loss: 0.1623, Time: 9.62s, Saved pixels: 65.62%
Loss: 0.4942
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   13.00    |
|    Average Batch Time (s)     |   0.0268   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1969.43   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 14
Train Loss: 0.1470, Time: 9.69s, Saved pixels: 65.62%
Loss: 0.5034
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   14.00    |
|    Average Batch Time (s)     |   0.0270   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1970.73   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 15
Train Loss: 0.1379, Time: 9.36s, Saved pixels: 65.62%
Loss: 0.5122
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   15.00    |
|    Average Batch Time (s)     |   0.0261   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1958.61   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 16
Train Loss: 0.1291, Time: 9.88s, Saved pixels: 65.62%
Loss: 0.5319
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   16.00    |
|    Average Batch Time (s)     |   0.0275   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1967.96   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 17
Train Loss: 0.1210, Time: 10.17s, Saved pixels: 65.62%
Loss: 0.5286
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   17.00    |
|    Average Batch Time (s)     |   0.0283   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1946.51   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 18
Train Loss: 0.1135, Time: 9.73s, Saved pixels: 65.62%
Loss: 0.5499
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   18.00    |
|    Average Batch Time (s)     |   0.0271   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1941.09   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 19
Train Loss: 0.1052, Time: 9.72s, Saved pixels: 65.62%
Loss: 0.5579
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   19.00    |
|    Average Batch Time (s)     |   0.0271   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1965.84   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 20
Train Loss: 0.0959, Time: 9.95s, Saved pixels: 65.62%
Loss: 0.5496
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   20.00    |
|    Average Batch Time (s)     |   0.0277   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1965.22   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 21
Train Loss: 0.0901, Time: 9.61s, Saved pixels: 65.62%
Loss: 0.5654
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   21.00    |
|    Average Batch Time (s)     |   0.0268   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  2109.48   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 22
Train Loss: 0.0866, Time: 9.59s, Saved pixels: 65.62%
Loss: 0.5726
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   22.00    |
|    Average Batch Time (s)     |   0.0267   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  1987.36   |
|   Energy Consumption (kWh)    | 0.0045 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 23
Train Loss: 0.0842, Time: 9.63s, Saved pixels: 65.62%
Loss: 0.5816
Early stopping at epoch 23
Training complete.
Evaluating on validation set:
Loss: 0.5122
Micro F1: 0.7017, Macro F1: 0.5442
Miss Rate: 0.3088, FPPI: 2.0549
Overall Acc: 0.8032, Precision: 0.7124, Recall: 0.6912, F1: 0.7017

Final evaluation on test set:
Loss: 0.5175
Micro F1: 0.6989, Macro F1: 0.5324
Miss Rate: 0.3103, FPPI: 2.0764
Overall Acc: 0.8025, Precision: 0.7083, Recall: 0.6897, F1: 0.6989
