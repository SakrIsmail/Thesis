Train: 5742, Val: 638, Test: 1596
Anchor part: back_pedal
Average anchor position: [323.4758003 289.5394436]
Average offsets for parts (example): {'back_pedal': array([0., 0.]), 'back_hand_break': array([ -41.00623624, -164.98789435]), 'front_pedal': array([28.69489194, 19.22082515])}
Epoch 1
Train Loss: 0.4636, Time: 22.22s, Saved pixels: 65.62%
Loss: 0.4306
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    1.00    |
|    Average Batch Time (s)     |   0.0309   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3215.80   |
|   Energy Consumption (kWh)    | 0.0092 kWh |
|      CO₂ Emissions (kg)       | 0.0025 kg  |
+-------------------------------+------------+
Epoch 2
Train Loss: 0.4115, Time: 21.68s, Saved pixels: 65.62%
Loss: 0.4106
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    2.00    |
|    Average Batch Time (s)     |   0.0302   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3199.33   |
|   Energy Consumption (kWh)    | 0.0093 kWh |
|      CO₂ Emissions (kg)       | 0.0025 kg  |
+-------------------------------+------------+
Epoch 3
Train Loss: 0.3831, Time: 21.26s, Saved pixels: 65.62%
Loss: 0.4046
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    3.00    |
|    Average Batch Time (s)     |   0.0296   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3134.39   |
|   Energy Consumption (kWh)    | 0.0093 kWh |
|      CO₂ Emissions (kg)       | 0.0025 kg  |
+-------------------------------+------------+
Epoch 4
Train Loss: 0.3590, Time: 21.75s, Saved pixels: 65.62%
Loss: 0.4088
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    4.00    |
|    Average Batch Time (s)     |   0.0303   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3144.52   |
|   Energy Consumption (kWh)    | 0.0093 kWh |
|      CO₂ Emissions (kg)       | 0.0025 kg  |
+-------------------------------+------------+
Epoch 5
Train Loss: 0.3345, Time: 21.81s, Saved pixels: 65.62%
Loss: 0.4117
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    5.00    |
|    Average Batch Time (s)     |   0.0304   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3214.39   |
|   Energy Consumption (kWh)    | 0.0093 kWh |
|      CO₂ Emissions (kg)       | 0.0025 kg  |
+-------------------------------+------------+
Epoch 6
Train Loss: 0.3120, Time: 20.82s, Saved pixels: 65.62%
Loss: 0.4188
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    6.00    |
|    Average Batch Time (s)     |   0.0290   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3211.87   |
|   Energy Consumption (kWh)    | 0.0093 kWh |
|      CO₂ Emissions (kg)       | 0.0025 kg  |
+-------------------------------+------------+
Epoch 7
Train Loss: 0.2904, Time: 21.47s, Saved pixels: 65.62%
Loss: 0.4322
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    7.00    |
|    Average Batch Time (s)     |   0.0299   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3168.25   |
|   Energy Consumption (kWh)    | 0.0093 kWh |
|      CO₂ Emissions (kg)       | 0.0025 kg  |
+-------------------------------+------------+
Epoch 8
Train Loss: 0.2683, Time: 21.48s, Saved pixels: 65.62%
Loss: 0.4581
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    8.00    |
|    Average Batch Time (s)     |   0.0299   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3232.03   |
|   Energy Consumption (kWh)    | 0.0093 kWh |
|      CO₂ Emissions (kg)       | 0.0025 kg  |
+-------------------------------+------------+
Epoch 9
Train Loss: 0.2488, Time: 19.50s, Saved pixels: 65.62%
Loss: 0.4720
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    9.00    |
|    Average Batch Time (s)     |   0.0272   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2047.42   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 10
Train Loss: 0.2314, Time: 19.96s, Saved pixels: 65.62%
Loss: 0.4824
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   10.00    |
|    Average Batch Time (s)     |   0.0278   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2123.53   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 11
Train Loss: 0.2145, Time: 20.51s, Saved pixels: 65.62%
Loss: 0.5027
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   11.00    |
|    Average Batch Time (s)     |   0.0286   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2135.64   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 12
Train Loss: 0.2008, Time: 19.93s, Saved pixels: 65.62%
Loss: 0.5169
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   12.00    |
|    Average Batch Time (s)     |   0.0278   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2124.28   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 13
Train Loss: 0.1863, Time: 20.09s, Saved pixels: 65.62%
Loss: 0.5352
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   13.00    |
|    Average Batch Time (s)     |   0.0280   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2083.61   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 14
Train Loss: 0.1730, Time: 20.28s, Saved pixels: 65.62%
Loss: 0.5395
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   14.00    |
|    Average Batch Time (s)     |   0.0282   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2098.99   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 15
Train Loss: 0.1618, Time: 19.83s, Saved pixels: 65.62%
Loss: 0.5649
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   15.00    |
|    Average Batch Time (s)     |   0.0276   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2073.73   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 16
Train Loss: 0.1527, Time: 19.60s, Saved pixels: 65.62%
Loss: 0.5737
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   16.00    |
|    Average Batch Time (s)     |   0.0273   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2072.01   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 17
Train Loss: 0.1426, Time: 20.33s, Saved pixels: 65.62%
Loss: 0.5952
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   17.00    |
|    Average Batch Time (s)     |   0.0283   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2037.11   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 18
Train Loss: 0.1368, Time: 20.13s, Saved pixels: 65.62%
Loss: 0.5985
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   18.00    |
|    Average Batch Time (s)     |   0.0280   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2133.39   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 19
Train Loss: 0.1281, Time: 20.29s, Saved pixels: 65.62%
Loss: 0.5972
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   19.00    |
|    Average Batch Time (s)     |   0.0283   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2082.86   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 20
Train Loss: 0.1253, Time: 20.10s, Saved pixels: 65.62%
Loss: 0.6177
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   20.00    |
|    Average Batch Time (s)     |   0.0280   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2098.37   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 21
Train Loss: 0.1178, Time: 19.67s, Saved pixels: 65.62%
Loss: 0.6241
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   21.00    |
|    Average Batch Time (s)     |   0.0274   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2060.14   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 22
Train Loss: 0.1143, Time: 20.55s, Saved pixels: 65.62%
Loss: 0.6310
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   22.00    |
|    Average Batch Time (s)     |   0.0286   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2088.53   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 23
Train Loss: 0.1074, Time: 20.50s, Saved pixels: 65.62%
Loss: 0.6641
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   23.00    |
|    Average Batch Time (s)     |   0.0285   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2050.98   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 24
Train Loss: 0.0850, Time: 20.31s, Saved pixels: 65.62%
Loss: 0.6598
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   24.00    |
|    Average Batch Time (s)     |   0.0283   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2137.41   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 25
Train Loss: 0.0764, Time: 20.58s, Saved pixels: 65.62%
Loss: 0.6677
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   25.00    |
|    Average Batch Time (s)     |   0.0287   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2137.07   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 26
Train Loss: 0.0720, Time: 20.12s, Saved pixels: 65.62%
Loss: 0.6692
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   26.00    |
|    Average Batch Time (s)     |   0.0280   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2336.99   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 27
Train Loss: 0.0680, Time: 19.66s, Saved pixels: 65.62%
Loss: 0.6903
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   27.00    |
|    Average Batch Time (s)     |   0.0274   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2129.43   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 28
Train Loss: 0.0681, Time: 20.34s, Saved pixels: 65.62%
Loss: 0.6880
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   28.00    |
|    Average Batch Time (s)     |   0.0283   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2127.64   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 29
Train Loss: 0.0638, Time: 19.46s, Saved pixels: 65.62%
Loss: 0.7004
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   29.00    |
|    Average Batch Time (s)     |   0.0271   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2112.03   |
|   Energy Consumption (kWh)    | 0.0090 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 30
Train Loss: 0.0621, Time: 20.59s, Saved pixels: 65.62%
Loss: 0.7144
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   30.00    |
|    Average Batch Time (s)     |   0.0287   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2082.37   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 31
Train Loss: 0.0600, Time: 20.03s, Saved pixels: 65.62%
Loss: 0.7221
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   31.00    |
|    Average Batch Time (s)     |   0.0279   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2054.91   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 32
Train Loss: 0.0578, Time: 18.89s, Saved pixels: 65.62%
Loss: 0.7096
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   32.00    |
|    Average Batch Time (s)     |   0.0263   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2125.50   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 33
Train Loss: 0.0564, Time: 20.03s, Saved pixels: 65.62%
Loss: 0.7283
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   33.00    |
|    Average Batch Time (s)     |   0.0279   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2088.32   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 34
Train Loss: 0.0553, Time: 19.93s, Saved pixels: 65.62%
Loss: 0.7234
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   34.00    |
|    Average Batch Time (s)     |   0.0278   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2141.89   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 35
Train Loss: 0.0541, Time: 20.07s, Saved pixels: 65.62%
Loss: 0.7298
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   35.00    |
|    Average Batch Time (s)     |   0.0279   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2146.55   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 36
Train Loss: 0.0528, Time: 19.93s, Saved pixels: 65.62%
Loss: 0.7311
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   36.00    |
|    Average Batch Time (s)     |   0.0278   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2130.95   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 37
Train Loss: 0.0436, Time: 19.97s, Saved pixels: 65.62%
Loss: 0.7252
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   37.00    |
|    Average Batch Time (s)     |   0.0278   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2119.82   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 38
Train Loss: 0.0409, Time: 20.26s, Saved pixels: 65.62%
Loss: 0.7427
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   38.00    |
|    Average Batch Time (s)     |   0.0282   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2073.16   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 39
Train Loss: 0.0382, Time: 19.81s, Saved pixels: 65.62%
Loss: 0.7277
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   39.00    |
|    Average Batch Time (s)     |   0.0276   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2094.14   |
|   Energy Consumption (kWh)    | 0.0089 kWh |
|      CO₂ Emissions (kg)       | 0.0024 kg  |
+-------------------------------+------------+
Epoch 40
Train Loss: 0.0374, Time: 19.57s, Saved pixels: 65.62%
Loss: 0.7550
Early stopping at epoch 40
Training complete.
Evaluating on validation set:
Loss: 0.7096
Micro F1: 0.6987, Macro F1: 0.5575
Miss Rate: 0.3203, FPPI: 1.9592
Overall Acc: 0.8037, Precision: 0.7187, Recall: 0.6797, F1: 0.6987

Final evaluation on test set:
Loss: 0.7128
Micro F1: 0.7033, Macro F1: 0.5606
Miss Rate: 0.3078, FPPI: 2.0207
Overall Acc: 0.8059, Precision: 0.7147, Recall: 0.6922, F1: 0.7033
