Train: 5742, Val: 638, Test: 1596
Anchor part: back_pedal
Average anchor position: [323.4758003 289.5394436]
Average offsets for parts (example): {'back_pedal': array([0., 0.]), 'back_hand_break': array([ -41.00623624, -164.98789435]), 'front_pedal': array([28.69489194, 19.22082515])}
Epoch 1
Train Loss: 0.4878, Time: 11.90s, Saved pixels: 65.62%
Loss: 0.4587
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    1.00    |
|    Average Batch Time (s)     |   0.0331   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3142.88   |
|   Energy Consumption (kWh)    | 0.0047 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 2
Train Loss: 0.4486, Time: 11.22s, Saved pixels: 65.62%
Loss: 0.4387
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    2.00    |
|    Average Batch Time (s)     |   0.0313   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3189.50   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 3
Train Loss: 0.4287, Time: 10.84s, Saved pixels: 65.62%
Loss: 0.4222
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    3.00    |
|    Average Batch Time (s)     |   0.0302   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3180.38   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 4
Train Loss: 0.4127, Time: 11.08s, Saved pixels: 65.62%
Loss: 0.4136
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    4.00    |
|    Average Batch Time (s)     |   0.0309   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3201.25   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 5
Train Loss: 0.3983, Time: 11.47s, Saved pixels: 65.62%
Loss: 0.4106
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    5.00    |
|    Average Batch Time (s)     |   0.0320   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3098.85   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 6
Train Loss: 0.3876, Time: 11.04s, Saved pixels: 65.62%
Loss: 0.4109
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    6.00    |
|    Average Batch Time (s)     |   0.0307   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3087.18   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 7
Train Loss: 0.3766, Time: 11.01s, Saved pixels: 65.62%
Loss: 0.4095
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    7.00    |
|    Average Batch Time (s)     |   0.0307   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3140.33   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 8
Train Loss: 0.3676, Time: 10.97s, Saved pixels: 65.62%
Loss: 0.4071
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    8.00    |
|    Average Batch Time (s)     |   0.0305   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3129.48   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 9
Train Loss: 0.3585, Time: 11.06s, Saved pixels: 65.62%
Loss: 0.4081
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |    9.00    |
|    Average Batch Time (s)     |   0.0308   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3150.80   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 10
Train Loss: 0.3487, Time: 10.88s, Saved pixels: 65.62%
Loss: 0.4092
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   10.00    |
|    Average Batch Time (s)     |   0.0303   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3152.08   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 11
Train Loss: 0.3392, Time: 11.16s, Saved pixels: 65.62%
Loss: 0.4091
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   11.00    |
|    Average Batch Time (s)     |   0.0311   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3134.96   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 12
Train Loss: 0.3313, Time: 11.20s, Saved pixels: 65.62%
Loss: 0.4143
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   12.00    |
|    Average Batch Time (s)     |   0.0312   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3169.68   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 13
Train Loss: 0.3217, Time: 11.04s, Saved pixels: 65.62%
Loss: 0.4177
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   13.00    |
|    Average Batch Time (s)     |   0.0308   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3140.96   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 14
Train Loss: 0.3137, Time: 10.80s, Saved pixels: 65.62%
Loss: 0.4179
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   14.00    |
|    Average Batch Time (s)     |   0.0301   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3201.46   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 15
Train Loss: 0.3038, Time: 10.78s, Saved pixels: 65.62%
Loss: 0.4277
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   15.00    |
|    Average Batch Time (s)     |   0.0300   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3185.63   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 16
Train Loss: 0.2953, Time: 10.80s, Saved pixels: 65.62%
Loss: 0.4314
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   16.00    |
|    Average Batch Time (s)     |   0.0301   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3160.48   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 17
Train Loss: 0.2709, Time: 10.95s, Saved pixels: 65.62%
Loss: 0.4281
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   17.00    |
|    Average Batch Time (s)     |   0.0305   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3124.15   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 18
Train Loss: 0.2596, Time: 10.52s, Saved pixels: 65.62%
Loss: 0.4353
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   18.00    |
|    Average Batch Time (s)     |   0.0293   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3142.55   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 19
Train Loss: 0.2497, Time: 11.08s, Saved pixels: 65.62%
Loss: 0.4441
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   19.00    |
|    Average Batch Time (s)     |   0.0309   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3130.42   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 20
Train Loss: 0.2439, Time: 10.99s, Saved pixels: 65.62%
Loss: 0.4460
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   20.00    |
|    Average Batch Time (s)     |   0.0306   |
| Maximum GPU Memory Usage (MB) |  4202.69   |
| Maximum CPU Memory Usage (MB) |  3170.92   |
|   Energy Consumption (kWh)    | 0.0048 kWh |
|      CO₂ Emissions (kg)       | 0.0013 kg  |
+-------------------------------+------------+
Epoch 21
Train Loss: 0.2368, Time: 10.08s, Saved pixels: 65.62%
Loss: 0.4530
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   21.00    |
|    Average Batch Time (s)     |   0.0281   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2032.30   |
|   Energy Consumption (kWh)    | 0.0046 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 22
Train Loss: 0.2296, Time: 10.10s, Saved pixels: 65.62%
Loss: 0.4631
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   22.00    |
|    Average Batch Time (s)     |   0.0281   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  1986.47   |
|   Energy Consumption (kWh)    | 0.0046 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 23
Train Loss: 0.2178, Time: 10.44s, Saved pixels: 65.62%
Loss: 0.4604
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   23.00    |
|    Average Batch Time (s)     |   0.0291   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  1990.47   |
|   Energy Consumption (kWh)    | 0.0046 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 24
Train Loss: 0.2081, Time: 10.01s, Saved pixels: 65.62%
Loss: 0.4658
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   24.00    |
|    Average Batch Time (s)     |   0.0279   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  1979.97   |
|   Energy Consumption (kWh)    | 0.0046 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 25
Train Loss: 0.2048, Time: 10.21s, Saved pixels: 65.62%
Loss: 0.4633
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   25.00    |
|    Average Batch Time (s)     |   0.0284   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2044.08   |
|   Energy Consumption (kWh)    | 0.0046 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 26
Train Loss: 0.2004, Time: 9.67s, Saved pixels: 65.62%
Loss: 0.4779
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   26.00    |
|    Average Batch Time (s)     |   0.0269   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  1978.08   |
|   Energy Consumption (kWh)    | 0.0046 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 27
Train Loss: 0.1966, Time: 9.81s, Saved pixels: 65.62%
Loss: 0.4753
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   27.00    |
|    Average Batch Time (s)     |   0.0273   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  1984.20   |
|   Energy Consumption (kWh)    | 0.0046 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 28
Train Loss: 0.1930, Time: 10.02s, Saved pixels: 65.62%
Loss: 0.4819
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   28.00    |
|    Average Batch Time (s)     |   0.0279   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  1977.11   |
|   Energy Consumption (kWh)    | 0.0046 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 29
Train Loss: 0.1886, Time: 10.14s, Saved pixels: 65.62%
Loss: 0.4854
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   29.00    |
|    Average Batch Time (s)     |   0.0283   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  1975.45   |
|   Energy Consumption (kWh)    | 0.0046 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 30
Train Loss: 0.1826, Time: 9.71s, Saved pixels: 65.62%
Loss: 0.4874
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   30.00    |
|    Average Batch Time (s)     |   0.0271   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2008.34   |
|   Energy Consumption (kWh)    | 0.0046 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 31
Train Loss: 0.1785, Time: 9.47s, Saved pixels: 65.62%
Loss: 0.4861
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   31.00    |
|    Average Batch Time (s)     |   0.0264   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  2024.64   |
|   Energy Consumption (kWh)    | 0.0046 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 32
Train Loss: 0.1775, Time: 10.87s, Saved pixels: 65.62%
Loss: 0.4928
+-------------------------------+------------+
|            Metric             |   Value    |
+-------------------------------+------------+
|             Epoch             |   32.00    |
|    Average Batch Time (s)     |   0.0303   |
| Maximum GPU Memory Usage (MB) |   98.56    |
| Maximum CPU Memory Usage (MB) |  1963.24   |
|   Energy Consumption (kWh)    | 0.0047 kWh |
|      CO₂ Emissions (kg)       | 0.0012 kg  |
+-------------------------------+------------+
Epoch 33
Train Loss: 0.1749, Time: 10.35s, Saved pixels: 65.62%
Loss: 0.4931
Early stopping at epoch 33
Training complete.
Evaluating on validation set:
Loss: 0.4633
Micro F1: 0.7140, Macro F1: 0.5572
Miss Rate: 0.3064, FPPI: 1.8354
Overall Acc: 0.8140, Precision: 0.7357, Recall: 0.6936, F1: 0.7140

Final evaluation on test set:
Loss: 0.4655
Micro F1: 0.7088, Macro F1: 0.5509
Miss Rate: 0.3089, FPPI: 1.8935
Overall Acc: 0.8113, Precision: 0.7274, Recall: 0.6911, F1: 0.7088
